<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tom의 결혼식</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
<audio id="bgm" loop>
    <source src="bgm.mp3" type="audio/mp3">
</audio>

<div id="musicBtn" class="music-btn music-playing">
    <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24" fill="currentColor">
        <path d="M560-131v-82q90-26 145-100t55-168q0-94-55-168T560-749v-82q124 28 202 125.5T840-481q0 127-78 224.5T560-131ZM120-360v-240h160l200-200v640L280-360H120Zm440 40v-322q47 22 73.5 66t26.5 96q0 51-26.5 94.5T560-320ZM400-606l-86 86H200v80h114l86 86v-252ZM300-480Z"/>
    </svg>
</div>
        
    <div class="intro-screen" id="introScreen">
        <div class="bg-slide slide-1"></div>
        <div class="bg-slide slide-2"></div>
        <div class="bg-slide slide-3"></div>
        <div class="overlay"></div>
        <div class="intro-content">
            <p class="names">We Marry</h1>
            <p class="names">DongWoo & JiWon</p>
        </div>
    </div>

    <div class="container">
        <div class="card">
            
            <img src="images/main.jpg" alt="메인사진" class="main-photo">
            <p class="intro">저희 결혼합니다</p>
            <hr>
            <p class="message">
                서로의 이름을 부르는 것만으로도<br>
                사랑의 깊이를 확인할 수 있는 두 사람이<br>
                꽃과 나무처럼 걸어와서<br>
                서로의 모든 것이 되려 합니다.
            </p>
            <h1>신랑 김동우 <span class="heart">♥</span> 신부 이지원</h1>

            <div class="profile-section">
                <div class="person">
                    <div class="img-frame">
                        <img src="images/groom.jpg" alt="신랑">
                    </div>
                    <h3>김동우</h3>
                    <p class="role">Groom</p>
                </div>
                <div class="person">
                    <div class="img-frame">
                        <img src="images/bride.jpg" alt="신부">
                    </div>
                    <h3>이지원</h3>
                    <p class="role">Bride</p>
                </div>
            </div>

            <hr class="divider-small">

            <div class="parents-section">
                <div class="parents-group">
                    <p class="family-label">신랑 측 혼주</p>
                    <div class="parents-row">
                        <div class="parent">
                            <img src="images/groom_f.jpg" class="parent-img" alt="아버지">
                            <span class="p-name">김아버지</span>
                        </div>
                        <div class="parent">
                            <img src="images/groom_m.jpg" class="parent-img" alt="어머니">
                            <span class="p-name">이어머니</span>
                        </div>
                    </div>
                </div>
                <div class="parents-group">
                    <p class="family-label">신부 측 혼주</p>
                    <div class="parents-row">
                        <div class="parent">
                            <img src="images/bride_f.jpg" class="parent-img" alt="아버지">
                            <span class="p-name">이아버지</span>
                        </div>
                        <div class="parent">
                            <img src="images/bride_m.jpg" class="parent-img" alt="어머니">
                            <span class="p-name">박어머니</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="info-box">
                <h2 class="box-title">예식장 정보</h2>
                <p class="date-point">2026. 05. 30. SAT</p>
                <p class="time-point">오전 10:00</p>
                <hr class="divider-mini"> 
                <p class="location">대구 파라다이스 웨딩컨벤션</p>
                <p class="hall-name">3층 그랜드볼룸</p>
                <p class="address-text">대구 달서구 달구벌대로 2003 (성서산업단지역)</p>
            </div>

            <div class="map-section">
                <div class="map-image-frame">
                    <img src="images/map.jpg" alt="오시는 길 약도">
                </div>
                <div class="nav-buttons">
                    <a href="https://naver.me/GrNfB5f4" target="_blank" class="btn-naver">네이버 지도</a>
                    <a href="https://kko.to/ywxN9OfrX9" target="_blank" class="btn-kakao">카카오맵</a>
                    <a href="tel:053-552-0500" class="btn-tel">예식장 전화</a>
                </div>
            </div>

            <hr class="divider">

            <div class="section-title">LOVE STORY</div>
            <div class="timeline-box">
                <div class="story">
                    <div class="year">2015</div>
                    <img src="images/time1.jpg" alt="고등학교">
                    <div class="text">
                        <h3>우리의 첫 만남</h3>
                        <p>설레던 고등학교 교복 데이트</p>
                    </div>
                </div>
                <div class="story">
                    <div class="year">2018</div>
                    <img src="images/time2.jpg" alt="대학생">
                    <div class="text">
                        <h3>CC의 낭만</h3>
                        <p>함께 꿈을 키우던 대학 시절</p>
                    </div>
                </div>
                <div class="story">
                    <div class="year">2021</div>
                    <img src="images/time3.jpg" alt="군대/사회">
                    <div class="text">
                        <h3>기다림과 응원</h3>
                        <p>서로가 서로에게 힘이 되어준 시간</p>
                    </div>
                </div>
                <div class="story">
                    <div class="year">2024</div>
                    <img src="images/time4.jpg" alt="프러포즈">
                    <div class="text">
                        <h3>Will You Marry Me?</h3>
                        <p>떨리던 프러포즈의 순간</p>
                    </div>
                </div>
                <div class="story">
                    <div class="year">2026</div>
                    <img src="images/time5.jpg" alt="결혼">
                    <div class="text">
                        <h3>우리, 결혼합니다</h3>
                        <p>11년 연애의 결실을 맺는 날</p>
                    </div>
                </div>
            </div>

            <hr class="divider">

            <div class="section-title">GALLERY</div>
            <div class="gallery-grid">
                <img src="images/gallery1.jpg" alt="사진1">
                <img src="images/gallery2.jpg" alt="사진2">
                <img src="images/gallery3.jpg" alt="사진3">
                <img src="images/gallery4.jpg" alt="사진4">
                <img src="images/gallery5.jpg" alt="사진5">
                <img src="images/gallery6.jpg" alt="사진6">
            </div>

            <hr class="divider">

<div class="guestbook-section">
    <div class="section-title">GUESTBOOK</div>
    
    <div class="input-area">
        <input type="text" id="gName" placeholder="이름" maxlength="10">
        <input type="password" id="gPw" placeholder="비밀번호(삭제용)" maxlength="4"> <textarea id="gMsg" placeholder="축하 메시지를 남겨주세요 (최대 100자)" maxlength="100"></textarea>
        <button id="btnSave" class="btn-submit">축하글 남기기</button>
    </div>

    <div id="guestbook-list" class="comment-list">
        <div class="loading-msg">데이터를 불러오는 중...</div>
    </div>
</div>
<script type="module">
  // 1. 필요한 기능 더 많이 가져오기 (deleteDoc, doc, getDoc 추가됨)
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getFirestore, collection, addDoc, query, orderBy, onSnapshot, serverTimestamp, deleteDoc, doc, getDoc } 
    from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  // ★ 여기에 본인의 Firebase 설정 코드를 다시 넣어주세요! ★
const firebaseConfig = {
  apiKey: "AIzaSyBWpaK9yGtZBlETdFbrD1gMXHxFLGF5NKs",
  authDomain: "wedding-invitation-1f182.firebaseapp.com",
  projectId: "wedding-invitation-1f182",
  storageBucket: "wedding-invitation-1f182.firebasestorage.app",
  messagingSenderId: "13755905635",
  appId: "1:13755905635:web:6453ebc774c77a8dac6a56",
  measurementId: "G-ZJ5YNX2CJJ"
};

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // --- 글쓰기 기능 (기존과 동일) ---
  document.getElementById("btnSave").addEventListener("click", async () => {
      const name = document.getElementById("gName").value;
      const pw = document.getElementById("gPw").value;
      const msg = document.getElementById("gMsg").value;

      if (!name || !msg || !pw) {
          alert("이름, 비밀번호, 내용을 모두 입력해주세요.");
          return;
      }

      try {
          await addDoc(collection(db, "guestbook"), {
              name: name,
              password: pw, // 삭제할 때 확인용
              message: msg,
              date: serverTimestamp()
          });
          alert("등록되었습니다!");
          document.getElementById("gMsg").value = ""; // 내용만 지워줌 (편의성)
      } catch (e) {
          console.error("Error", e);
          alert("저장 실패");
      }
  });

  // --- 실시간 목록 보기 & 삭제 버튼 달기 ---
  const q = query(collection(db, "guestbook"), orderBy("date", "desc"));
  
  onSnapshot(q, (snapshot) => {
      const listDiv = document.getElementById("guestbook-list");
      listDiv.innerHTML = ""; 

      snapshot.forEach((document) => {
          const data = document.data();
          const docId = document.id; // 문서의 고유 ID (삭제할 때 필요)
          const dateStr = data.date ? new Date(data.date.seconds * 1000).toLocaleDateString() : "";
          
          const itemHtml = `
            <div class="comment-item">
                <div class="c-header">
                    <span class="c-name">${data.name}</span>
                    <span class="c-date">${dateStr}</span>
                </div>
                <div class="c-msg">${data.message}</div>
                <button class="btn-del" onclick="window.deleteComment('${docId}')">삭제</button>
            </div>
          `;
          listDiv.innerHTML += itemHtml;
      });
  });

  // --- 삭제 기능 함수 (전역 window에 등록해야 HTML에서 클릭 가능) ---
  window.deleteComment = async (id) => {
      const userPw = prompt("비밀번호를 입력하세요");
      if (!userPw) return;

      try {
          // 1. 해당 글의 정보를 가져옴
          const docRef = doc(db, "guestbook", id);
          const docSnap = await getDoc(docRef);
          
          if (docSnap.exists()) {
              const realPw = docSnap.data().password;
              
              // 2. 비밀번호 비교
              if (userPw === realPw) {
                  await deleteDoc(docRef); // 진짜 삭제
                  alert("삭제되었습니다.");
              } else {
                  alert("비밀번호가 틀렸습니다.");
              }
          }
      } catch (e) {
          console.error("Delete Error", e);
          alert("삭제 중 오류가 발생했습니다.");
      }
  };
</script>
            <hr class="divider">

            <div class="account-section">
                <div class="section-title">마음 전하실 곳</div>
                
                <details class="acc-details">
                    <summary class="acc-summary groom-bg">신랑측 계좌번호 보기</summary>
                    <div class="acc-content">
                        <div class="acc-row">
                            <span class="acc-who">신랑 김동우</span>
                            <span class="acc-num">대구은행 508-41-123123-13</span>
                            <button class="btn-copy" onclick="copyText('대구은행 5084112312313')">복사</button>
                        </div>
                        <div class="acc-row">
                            <span class="acc-who">아버지 김흥만</span>
                            <span class="acc-num">우리은행 508-12-31321</span>
                            <button class="btn-copy" onclick="copyText('우리은행 5081231321')">복사</button>
                        </div>
                        <div class="acc-row">
                            <span class="acc-who">어머니 김혜정</span>
                            <span class="acc-num">우리은행 115-159-61621321</span>
                            <button class="btn-copy" onclick="copyText('우리은행 11515961621321')">복사</button>
                        </div>
                    </div>
                </details>

                <details class="acc-details">
                    <summary class="acc-summary bride-bg">신부측 계좌번호 보기</summary>
                    <div class="acc-content">
                        <div class="acc-row">
                            <span class="acc-who">신부 이지원</span>
                            <span class="acc-num">우리은행 123-123-1231231</span>
                            <button class="btn-copy" onclick="copyText('우리은행 1231231231231')">복사</button>
                        </div>
                        <div class="acc-row">
                            <span class="acc-who">아버지 이영식</span>
                            <span class="acc-num">농협 122-31-23321</span>
                            <button class="btn-copy" onclick="copyText('농협 1223123321')">복사</button>
                        </div>
                        <div class="acc-row">
                            <span class="acc-who">어머니 전수경</span>
                            <span class="acc-num">새마을 1231-5365-743289</span>
                            <button class="btn-copy" onclick="copyText('새마을 12315365743289')">복사</button>
                        </div>
                    </div>
                </details>
            </div>

        </div> </div> <script src="script.js"></script>
</body>
</html>